define(["jquery","vk","plugins/format"],function(e,t,n){function u(e){return e.indexOf("http://cs")===-1?e.replace("http://","https://"):"https://pp.vk.me/c"+e.replace("http://cs","").replace(".vk.me","")}function a(e){return{id:e.uid||e.id,img:u(e.photo_50),name:e.first_name+" "+e.last_name}}var r="71627954",i="photo-71627954_332801553",s="https://vk.com/app4446829",o="Занятое место на чемпионате мира: {0}. Попробуй свои силы в послематчевых пенальти на чемпионате мира 2014 {1}";return{init:function(){return e.Deferred(function(e){VK.init(function(){VK.init(function(){e.resolve()},function(){},"5.21")})})},getUserUrl:function(e){return"https://vk.com/id"+e},getUnknowImg:function(){return"//vk.com/images/deactivated_50.gif"},invite:function(){VK.callMethod("showInviteBox")},wallPost:function(t){return e.Deferred(function(e){VK.api("wall.post",{attachments:i,message:n(o,t,s)},function(t){e.resolve(t)})})},getUsers:function(t){return e.Deferred(function(e){function n(t){t.error&&e.resolve([]);var n=[];t.response.forEach(function(e){n.push(a(e))}),e.resolve(n)}window.DEBUG?n({response:[{id:1,first_name:"AAA",last_name:"BBB",photo_50:"http://cs421118.vk.me/v421118333/924b/C790w8WkLxE.jpg"}]}):VK.api("users.get",{user_ids:t,fields:"photo_50",name_case:"Nom"},n)})},getFriendsUsers:function(){return e.Deferred(function(e){VK.api("friends.getAppUsers",function(t){e.resolve(t.response)})})},isUserInGroup:function(t){return e.Deferred(function(e){VK.api("groups.isMember",{user_id:t,group_id:r},function(t){e.resolve(t.response.member===1)})})}}});